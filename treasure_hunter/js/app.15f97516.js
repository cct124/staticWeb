(function(t){function e(e){for(var r,n,h=e[0],o=e[1],c=e[2],u=0,f=[];u<h.length;u++)n=h[u],Object.prototype.hasOwnProperty.call(i,n)&&i[n]&&f.push(i[n][0]),i[n]=0;for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(t[r]=o[r]);l&&l(e);while(f.length)f.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var t,e=0;e<s.length;e++){for(var a=s[e],r=!0,h=1;h<a.length;h++){var o=a[h];0!==i[o]&&(r=!1)}r&&(s.splice(e--,1),t=n(n.s=a[0]))}return t}var r={},i={app:0},s=[];function n(e){if(r[e])return r[e].exports;var a=r[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=r,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(a,r,function(e){return t[e]}.bind(null,r));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/";var h=window["webpackJsonp"]=window["webpackJsonp"]||[],o=h.push.bind(h);h.push=e,h=h.slice();for(var c=0;c<h.length;c++)e(h[c]);var l=o;s.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("cd49")},1427:function(t,e,a){"use strict";a("fc73")},"1b34":function(t,e,a){},b20f:function(t,e,a){},cd49:function(t,e,a){"use strict";a.r(e);a("e623"),a("e379"),a("5dc8"),a("37e1");var r=a("7a23");function i(t,e){var a=Object(r["v"])("router-view");return Object(r["o"])(),Object(r["c"])(a)}a("d4d9");var s=a("6b0d"),n=a.n(s);const h={},o=n()(h,[["render",i]]);var c=o,l=a("6c02"),u={class:"index flex flex-column"},f={class:"game-container flex-center",ref:"container"},p={class:"control relative",ref:"control"};function d(t,e,a,i,s,n){var h=Object(r["v"])("GameComponents");return Object(r["o"])(),Object(r["d"])("div",u,[Object(r["e"])("div",f,[Object(r["f"])(h,{ref:"game"},null,512)],512),Object(r["e"])("div",p,null,512)])}var g=a("b85c"),m=a("d4ec"),y=a("bee2"),v=a("262e"),b=a("2caf"),w=(a("d3b7"),a("b0c0"),a("9ab4")),j=a("ce1f"),O={class:"game",ref:"game"};function k(t,e,a,i,s,n){return Object(r["o"])(),Object(r["d"])("canvas",O,null,512)}var x=a("5530"),B=(a("18a5"),a("159b"),a("7aaa")),M=Object(y["a"])((function t(e,a){Object(m["a"])(this,t),this.container=e,this.target=a,this.cr=this.container.width/this.container.height,this.tr=this.target.width/this.target.height,this.trw=this.container.width/this.target.width,this.trh=this.container.height/this.target.height}));a("fb6a"),a("a630"),a("3ca3"),a("ddb0"),a("b680");function T(t,e){return Array.from(new Array(e+1).keys()).slice(t)}function S(t,e,a){var r=0,i=0;switch(e<=t?(i=e,r=t):(i=t,r=e),arguments.length){case 1:return Math.floor(Math.random()*(r+1));case 2:return Math.floor(Math.random()*(r-i+1)+i);case 3:return parseFloat((Math.random()*(r-i)+i).toFixed(a));default:return Math.random()}}var G,P,C=a("cffa"),N=function(){function t(e,a){var r=this;Object(m["a"])(this,t),this.adap=null,this.gameScene=new B["b"],this.gameUIScene=new B["b"],this.gameMessage=new B["b"],this.monster={list:[],spacing:48,xOffset:150,monsterNum:6,speed:4,direction:1,attackPower:[20,50],attackInterval:500},this.healthBar={container:new B["b"],grapBar:new B["c"],timeline:null},this.messages={full:void 0,failText:"GAME OVER!",victoryText:"Victory!"},this.player={target:void 0,offsetX:0,offsetY:0,speed:2,health:100,curHealth:100,beingAttacked:!1,die:!1},this.treasure={target:void 0,hit:!1},this.wallThickness=30,this.joystickStart=!1,this.victory=!1,this.gameFail=!1,this.ref=e,this.app=new B["a"](Object(x["a"])(Object(x["a"])({},a),{},{view:e})),this.assets=a.assets,this.resource=a.resource,this.spriteNames=a.spriteNames,this.monster.monsterNum=a.monsterNum,this.contain=a.contain,this.mainTextures=this.resource[this.assets.main.name].textures,this.dungeon=new B["e"](this.mainTextures[this.spriteNames.dungeon]),this.door=new Y({textures:this.mainTextures[this.spriteNames.door],id:0}),this.door.sprite.position.set(this.wallThickness,0),this.treasure.target=new X({textures:this.mainTextures[this.spriteNames.treasure],id:0}),this.treasure.target.sprite.position.set(this.app.view.width-this.treasure.target.sprite.width-this.wallThickness,this.app.view.height/2-this.treasure.target.sprite.height/2),this.app.stage.addChild(this.gameScene),this.app.stage.addChild(this.gameUIScene),this.gameScene.addChild(this.dungeon),this.gameScene.addChild(this.door.sprite),this.gameScene.addChild(this.treasure.target.sprite),this.gameUIScene.addChild(this.gameMessage),this.createMonster(this.mainTextures[this.spriteNames.blob]),this.createHealthBar(),this.createMessage(this.messages.victoryText),this.createPlayer(this.mainTextures[this.spriteNames.explorer]),this.app.ticker.add((function(t){return r.ticker(t)}))}return Object(y["a"])(t,[{key:"createMonster",value:function(t){var e,a=Object(g["a"])(T(0,this.monster.monsterNum));try{for(a.s();!(e=a.n()).done;){var r=e.value,i=S(0,1),s=new A({textures:t,id:r,vy:this.monster.speed*this.monster.direction*(i?-1:1)}),n=this.monster.spacing*r+this.monster.xOffset-this.wallThickness,h=S(this.wallThickness,this.app.stage.height-s.sprite.height-this.wallThickness);s.move(n,h),this.monster.list.push(s),this.gameScene.addChild(s.sprite)}}catch(o){a.e(o)}finally{a.f()}return this.monster}},{key:"createHealthBar",value:function(){this.healthBar.container.position.set(this.app.stage.width-100,10),this.gameUIScene.addChild(this.healthBar.container);var t=new B["c"];return t.beginFill(0),t.drawRect(0,0,128,8),t.endFill(),this.healthBar.container.addChild(t),this.healthBar.grapBar=new B["c"],this.healthBar.grapBar.beginFill(16724736),this.healthBar.grapBar.drawRect(0,0,128,8),this.healthBar.grapBar.endFill(),this.healthBar.container.addChild(this.healthBar.grapBar),this.healthBar.container.pivot.set(this.healthBar.container.width/2,this.healthBar.container.height/2),this.healthBar}},{key:"createMessage",value:function(t){if(this.messages.full)this.messages.full.text=t;else{var e=new B["g"]({fontFamily:"Futura",fontSize:64,fill:"white"});this.messages.full=new B["f"](t,e),this.messages.full.visible=!1,this.gameMessage.addChild(this.messages.full)}this.messages.full.anchor.set(.5),this.messages.full.x=this.app.stage.width/2,this.messages.full.y=this.app.stage.height/2}},{key:"createPlayer",value:function(t){this.player.target=new F({textures:t,id:0}),this.player.target.sprite.position.set(this.wallThickness,this.app.view.height/2-this.player.target.sprite.height/2),this.gameScene.addChild(this.player.target.sprite)}},{key:"monsterMove",value:function(){var t=this;this.monster.list.forEach((function(e){e.sprite.y+=e.vy;var a=_(e.sprite,t.contain);if(a!==G.top&&a!==G.bottom||(e.vy*=-1),t.player.target&&I(t.player.target,e)&&!t.player.beingAttacked&&!t.player.die){t.player.beingAttacked=!0,t.player.curHealth-=S(t.monster.attackPower[1],t.monster.attackPower[0]);var r=t.player.curHealth/t.player.health;t.healthBar.grapBar.width=t.healthBar.grapBar.width*r,t.shakeHealthBar(t.healthBar.container),r<0&&(t.healthBar.grapBar.width=0,t.messages.full&&(t.createMessage(t.messages.failText),t.messages.full.visible=!0,t.player.target.sprite.visible=!1,t.player.die=!0,t.gameFail=!0)),setTimeout((function(){t.player.beingAttacked=!1}),t.monster.attackInterval)}}))}},{key:"shakeHealthBar",value:function(t){var e=this;this.healthBar.timeline||(this.healthBar.timeline=C["a"].timeline(),this.healthBar.timeline.to(t,{rotation:10*Math.PI/180,duration:.06,repeat:1,yoyo:!0,onComplete:function(){e.healthBar.timeline=null}}))}},{key:"setPlayerOffset",value:function(t,e){return this.player.offsetX=t,this.player.offsetY=e,{offsetX:this.player.offsetX,offsetY:this.player.offsetY}}},{key:"playerMove",value:function(t,e){if(!this.victory&&!this.gameFail){if(this.player.target&&this.joystickStart){var a=this.player.target.sprite.x+t*this.player.speed,r=this.player.target.sprite.y-e*this.player.speed,i=_(this.player.target.sprite,this.contain);if(i===G.top||i===G.right||i===G.bottom||i===G.left)return;this.player.target.move(a,r),this.checkTreasure(),this.checkDoor()}return this.player.target}}},{key:"checkTreasure",value:function(){if(this.player.target&&this.treasure.target)return this.treasure.hit&&!this.player.die?(this.treasure.target.sprite.x=this.player.target.sprite.x,void(this.treasure.target.sprite.y=this.player.target.sprite.y)):void(I(this.player.target,this.treasure.target)&&(this.treasure.hit=!0))}},{key:"checkDoor",value:function(){this.player.target&&this.treasure.hit&&I(this.player.target,this.door)&&(this.createMessage(this.messages.victoryText),this.messages.full&&(this.messages.full.visible=!0),this.victory=!0)}},{key:"ticker",value:function(t){this.monsterMove(),this.playerMove(this.player.offsetX,this.player.offsetY)}},{key:"adaptation",value:function(t){return this.adap=new M({width:t.offsetWidth,height:t.offsetHeight},{width:this.ref.offsetWidth,height:this.ref.offsetHeight}),this.adap}}]),t}(),H=function(){function t(e){var a=e.textures,r=e.id;Object(m["a"])(this,t),this.centerX=0,this.centerY=0,this.halfWidth=0,this.halfHeight=0,this.sprite=new B["e"](a),this.id=r}return Object(y["a"])(t,[{key:"move",value:function(t,e){return this.sprite.x=t,this.sprite.y=e,this}}]),t}(),A=function(t){Object(v["a"])(a,t);var e=Object(b["a"])(a);function a(t){var r,i=t.textures,s=t.id,n=t.vy;return Object(m["a"])(this,a),r=e.call(this,{textures:i,id:s}),r.vy=0,r.vy=n,r}return Object(y["a"])(a)}(H),F=function(t){Object(v["a"])(a,t);var e=Object(b["a"])(a);function a(t){var r=t.textures,i=t.id;return Object(m["a"])(this,a),e.call(this,{textures:r,id:i})}return Object(y["a"])(a)}(H),X=function(t){Object(v["a"])(a,t);var e=Object(b["a"])(a);function a(t){var r=t.textures,i=t.id;return Object(m["a"])(this,a),e.call(this,{textures:r,id:i})}return Object(y["a"])(a)}(H),Y=function(t){Object(v["a"])(a,t);var e=Object(b["a"])(a);function a(t){var r=t.textures,i=t.id;return Object(m["a"])(this,a),e.call(this,{textures:r,id:i})}return Object(y["a"])(a)}(H);function _(t,e){return t.x<e.x?(t.x=e.x,G.left):t.y<e.y?(t.y=e.y,G.top):t.x+t.width>e.width?(t.x=e.width-t.width,G.right):t.y+t.height>e.height?(t.y=e.height-t.height,G.bottom):void 0}function I(t,e){var a;a=!1,t.centerX=t.sprite.x+t.sprite.width/2,t.centerY=t.sprite.y+t.sprite.height/2,e.centerX=e.sprite.x+e.sprite.width/2,e.centerY=e.sprite.y+e.sprite.height/2,t.halfWidth=t.sprite.width/2,t.halfHeight=t.sprite.height/2,e.halfWidth=e.sprite.width/2,e.halfHeight=e.sprite.height/2;var r=t.centerX-e.centerX,i=t.centerY-e.centerY,s=t.halfWidth+e.halfWidth,n=t.halfHeight+e.halfHeight;return a=Math.abs(r)<s&&Math.abs(i)<n,a}(function(t){t["left"]="left",t["top"]="top",t["right"]="right",t["bottom"]="bottom"})(G||(G={})),function(t){t["treasureHunter"]="treasure_hunter",t["dungeon"]="dungeon.png",t["blob"]="blob.png",t["explorer"]="explorer.png",t["treasure"]="treasure.png",t["door"]="door.png"}(P||(P={}));var W={assets:{main:{path:"./assets/treasure_hunter.json",name:P.treasureHunter}},spriteNames:{dungeon:P.dungeon,blob:P.blob,explorer:P.explorer,treasure:P.treasure,door:P.door},stage:{width:512,height:512,backgroundColor:2632756,contain:{x:28,y:10,width:488,height:480}}},U=W,$=function(t){Object(v["a"])(a,t);var e=Object(b["a"])(a);function a(){return Object(m["a"])(this,a),e.apply(this,arguments)}return Object(y["a"])(a,[{key:"game",get:function(){return this.$refs.game}},{key:"init",value:function(t){return this.Game=new N(this.game,Object(x["a"])(Object(x["a"])({},U.stage),{},{resource:t.resources,assets:U.assets,spriteNames:U.spriteNames,monsterNum:6})),this.Game}}]),a}(j["b"]);$=Object(w["a"])([Object(j["a"])({})],$);var E=$;const R=n()(E,[["render",k]]);var z=R,D=a("caaf"),J=a.n(D),V=function(t){Object(v["a"])(a,t);var e=Object(b["a"])(a);function a(){var t;return Object(m["a"])(this,a),t=e.apply(this,arguments),t.assets=[U.assets.main],t.loader=new B["d"],t}return Object(y["a"])(a,[{key:"game",get:function(){return this.$refs.game}},{key:"container",get:function(){return this.$refs.container}},{key:"adaptation",value:function(){this.game.Game&&(this.game.Game.adaptation(this.container),this.game.Game.adap&&(this.game.Game.adap.cr>this.game.Game.adap.tr?this.game.Game.ref.style.transform="scale(".concat(this.game.Game.adap.trh,")"):this.game.Game.ref.style.transform="scale(".concat(this.game.Game.adap.trw,")")))}},{key:"loaderAssets",value:function(){var t=this;return new Promise((function(e,a){try{t.loader.onComplete.add(e);var r,i=Object(g["a"])(t.assets);try{for(i.s();!(r=i.n()).done;){var s=r.value;t.loader.add(s.name,s.path)}}catch(n){i.e(n)}finally{i.f()}t.loader.load(t.loaderAssetsProgress)}catch(h){a(h)}}))}},{key:"loaderAssetsProgress",value:function(t){console.log(t)}},{key:"initNipplejs",value:function(){var t=this,e=J.a.create({zone:this.$refs.control,mode:"static",position:{left:"50%",top:"50%"},color:"#5f6368"});e.on("move",(function(e,a){t.joystickMove(e,a)})),e.on("start",(function(){t.game.Game&&(t.game.Game.joystickStart=!0)})),e.on("end",(function(){t.game.Game&&(t.game.Game.joystickStart=!1)}))}},{key:"joystickMove",value:function(t,e){var a=Math.cos(e.angle.radian),r=Math.sin(e.angle.radian);this.game.Game&&this.game.Game.setPlayerOffset(a,r)}},{key:"mounted",value:function(){var t=this;this.loaderAssets().then((function(e){t.game.init(e),t.adaptation(),t.initNipplejs()}))}}]),a}(j["b"]);V=Object(w["a"])([Object(j["a"])({components:{GameComponents:z}})],V);var q=V;a("1427");const K=n()(q,[["render",d],["__scopeId","data-v-68391e96"]]);var L=K,Q=[{path:"/",name:"Index",component:L}],Z=Object(l["a"])({history:Object(l["b"])(),routes:Q}),tt=Z,et=a("5502"),at=Object(et["a"])({state:{},mutations:{},actions:{},modules:{}});a("f5df1"),a("b20f");Object(r["b"])(c).use(at).use(tt).mount("#app")},d4d9:function(t,e,a){"use strict";a("1b34")},fc73:function(t,e,a){}});
//# sourceMappingURL=app.15f97516.js.map